function Engine(){var e=this;this.mobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),this.setupDate=function(){var t=!0,a=new Date,i=new Date;if(this.grab("puDay")){var n=this.grab("puDay"),s=this.grab("puMonth")-1,o=this.grab("puYear"),r=this.grab("doDay"),d=this.grab("doMonth")-1,c=this.grab("doYear");n&&s&&o&&r&&d&&c&&(t=!1,a=new Date(o,s,n),i=new Date(c,d,r),$("#puDay").val(n),$("#puMonth").val(s+1),$("#puYear").val(o),$("#doDay").val(r),$("#doMonth").val(d+1),$("#doYear").val(c))}if(t){var h=new Date;a.setDate(h.getDate()+3),i.setDate(h.getDate()+6),$("#puDay").val(a.getDate()),$("#puMonth").val(a.getMonth()+1),$("#puYear").val(a.getFullYear()),$("#doDay").val(i.getDate()),$("#doMonth").val(i.getMonth()+1),$("#doYear").val(i.getFullYear())}if(this.mobile)$("body").addClass("mobile"),document.getElementById("mobile-pickup").valueAsDate=a,document.getElementById("mobile-dropoff").valueAsDate=i,$("#mobile-pickup").on("change",function(e){var t=Date.parse(e.target.value),a=new Date(t);$("#puDay").val(a.getDate()),$("#puMonth").val(a.getMonth()+1),$("#puYear").val(a.getFullYear())}),$("#mobile-dropoff").on("change",function(e){var t=Date.parse(e.target.value),a=new Date(t);$("#doDay").val(a.getDate()),$("#doMonth").val(a.getMonth()+1),$("#doYear").val(a.getFullYear())});else{this.pointerSet=function(e){var t=$(e),a=$("#ui-datepicker-div");t.addClass("focus"),a.removeClass("no-pointer");var i=a.css("top"),n=t.offset();parseInt(i)<n.top&&a.addClass("no-pointer")},this.updateDates=function(e,t){var a=t,i=e;$("#"+a+"Day").val(i.getDate()),$("#"+a+"Month").val(i.getMonth()+1),$("#"+a+"Year").val(i.getFullYear())};var l=this.grab("format");l=l?l.replace(/\+/g," "):"D d M y";var u=this.grab("calendar");u=u?u:1,$("#mobile-pickup").replaceWith('<input readonly="readonly" type="text" class="input-text input-date datepicker-pickup date-pickup" id="datepicker-pickup" />'),$("#mobile-dropoff").replaceWith('<input readonly="readonly" type="text" class="input-text input-date datepicker-dropoff date-dropoff" id="datepicker-dropoff" />'),$("#datepicker-pickup").datepicker({dateFormat:l,minDate:0,showOtherMonths:!0,dayNamesMin:dayNamesMin,dayNamesShort:dayNamesShort,monthNamesShort:monthNamesShort,monthNames:monthNames,firstDay:1,numberOfMonths:[1,u],isRTL:e.rtl,onSelect:function(){a=$(this).datepicker("getDate"),$("#datepicker-dropoff").datepicker("option","minDate",a).trigger("blur"),e.updateDates(a,"pu"),a>i&&e.updateDates(a,"do")},onClose:function(){$(this).removeClass("focus")}}).datepicker("setDate",a).on("click",function(t){e.pointerSet(t.target)}),$("#datepicker-dropoff").datepicker({dateFormat:l,minDate:a,showOtherMonths:!0,dayNamesMin:dayNamesMin,dayNamesShort:dayNamesShort,monthNamesShort:monthNamesShort,monthNames:monthNames,firstDay:1,numberOfMonths:[1,u],onSelect:function(){i=$(this).datepicker("getDate"),e.updateDates(i,"do")},onClose:function(){$(this).removeClass("focus")}}).datepicker("setDate",i).on("click",function(t){e.pointerSet(t.target)})}},this.initChosen=function(){if(!this.mobile){var t=this.grab("fts");if(t){var a="location"===t?".locations select":"select";this.hasChosen=!0,this.hasChosenLocation="location"===t?!0:!1,$(a+":last").on("chosen:ready",function(){$("body").addClass("chosen-"+t),e.msnry.layout()}),$.getScript("/js/vendor/chosen/chosen.jquery.min.js",function(){var t=e.rtl?"rtl":"ltr",i=$(a);i.unwrap().addClass("chosen-"+t),i.chosen({disable_search_threshold:8,no_results_text:noResults,width:"100%",search_contains:!0})})}}},this.initMasonry=function(){var t=document.querySelector(".container > .content"),a=new Masonry(t,{columnWidth:".grid-sizer",itemSelector:".module",isOriginLeft:!e.rtl});e.msnry=a,e.postHeight()},this.setResizeEvent=function(){window.addEventListener?window.addEventListener("resize",e.postHeight,!1):window.attachEvent("onresize",e.postHeight)},this.postHeight=function(){var e=$("body").height();window.top.postMessage(e+"","*")},this.grab=function(e){var t="[\\?&]"+e+"=([^&#]*)",a=new RegExp(t),i=a.exec(this.location);return null===i?!1:i[1]},this.importDeals=function(){if($(".module-destinations").is(":visible")){if("us"===this.cor)$(".module-destinations").remove();else{var t=Modernizr.testAllProps("transform"),a="http:"===window.location.protocol?"http://www.rentalcars.com":"https://secure.rentalcars.com";$("#destinations-wrap").load(a+" .destination",function(){if($(".destination_country").size()<=0){var a=$(this);re=new RegExp("（.*?）"),a.addClass("destinations-alt").find(".destination").each(function(a){switch(a){case 0:case 1:case 2:case 3:var i=$(this),n=i.find(".destinationinfo"),s=i.children("img"),o=s.attr("src");n.find("img, p").wrapAll('<div class="destination_country"></div>'),n.find("h4, .destination_country p").each(function(){$(this).text(function(){return $(this).text().replace(/（.*?\）/g,"")})}),i.find(".destinationprice").addClass("destination_price").appendTo(n),i.addClass("destination-"+(a+1)),$("<div></div>").addClass("destination_img").css("background-image","url("+o+")").prependTo(i),s.remove(),t?i.addClass("scale-in"):i.hide().fadeIn(250),e.masonryRefresh();break;default:$(this).remove(),e.masonryRefresh()}})}else{var a=$(this);a.find(".destination_booked_recency").remove(),a.find(".destination").each(function(a){switch(a){case 0:case 1:case 2:case 3:var i=$(this);i.addClass("destination-"+(a+1)),t?i.addClass("scale-in"):i.hide().fadeIn(250),e.masonryRefresh();break;default:$(this).remove(),e.masonryRefresh()}})}})}this.postHeight()}},this.masonryRefresh=function(){void 0!=this.msnry&&this.msnry.layout()},this.isIE=function(){if(document.all){if(document.querySelector&&!document.addEventListener)return 8;if(!document.querySelector)return 7}return!1},this.readCookies=function(){for(c=document.cookie.split("; "),cookies={},i=c.length-1;i>=0;i--)C=c[i].split("="),cookies[C[0]]=C[1];return cookies},this.cookiePreference=function(e){var t=new RegExp(e+":([^|]*)"),a=t.exec(this.cookies.tj_conf);if(null!==a)return a[1];switch(e){case"lang":return this.grab("preflang");case"cor":return this.grab("cor");default:return!1}},this.generateCSS=function(){var e=$('style[id^="less"]'),t=e.text(),a=$("#css-media"),i=$("<textarea></textarea>");$.ajax({url:a.prop("href"),dataType:"text",success:function(e){t+=e,i.val(t),$("body").append(i)}})},this.formTarget=function(){var e=this.grab("target");"blank"===e&&(document.SearchResultsForm.target="_"+e)},this.setVariables=function(){this.location=window.location.href,this.cookies=this.readCookies(),this.preflang=this.cookiePreference("lang"),this.cor=this.cookiePreference("cor"),this.rtl=$("body").hasClass("rtl"),this.hasChosen=!1,this.IE=this.isIE()},this.init=function(){this.setVariables(),this.setupDate(),7!==this.IE&&(this.initMasonry(),this.initChosen(),8===this.IE&&window.setTimeout(e.masonryRefresh,3e3)),this.importDeals(),this.formTarget(),this.setResizeEvent()}}